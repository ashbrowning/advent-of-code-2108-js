Decided to try a memory-efficient approach, which should be more perfomant when the input is large
